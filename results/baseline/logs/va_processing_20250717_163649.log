2025-07-17 16:36:49,977 - root - INFO - Logging configured. Log file: results/baseline/logs/va_processing_20250717_163649.log
2025-07-17 16:36:49,977 - baseline.data.data_loader_preprocessor - INFO - Output directories created at: results/baseline/processed_data
2025-07-17 16:36:49,977 - baseline.data.data_loader_preprocessor - INFO - Initialized VADataProcessor with config: data_path='data/raw/PHMRC/IHME_PHMRC_VA_DATA_ADULT_Y2013M09D11_0.csv' output_dir='results/baseline/' openva_encoding=False drop_columns=[] stratify_by_site=False
2025-07-17 16:36:49,977 - baseline.data.data_loader_preprocessor - INFO - Loading PHMRC data from data/raw/PHMRC/IHME_PHMRC_VA_DATA_ADULT_Y2013M09D11_0.csv
2025-07-17 16:36:52,476 - baseline.data.data_loader_preprocessor - INFO - Validated 7582 records with 197 columns
2025-07-17 16:36:52,581 - baseline.data.data_loader_preprocessor - INFO - Data statistics at post-validation: {
  "stage": "post-validation",
  "n_samples": 7582,
  "n_features": 197,
  "missing_values": 0,
  "memory_usage_mb": 65.29185104370117,
  "n_classes": 34,
  "class_distribution": {
    "32": 607,
    "25": 581,
    "26": 528,
    "1": 474,
    "21": 451,
    "9": 402,
    "29": 402,
    "22": 400,
    "17": 393,
    "6": 303,
    "34": 266,
    "23": 251,
    "10": 224,
    "30": 194,
    "4": 190,
    "14": 168,
    "8": 167,
    "16": 161,
    "18": 150,
    "5": 148,
    "33": 121,
    "15": 119,
    "11": 106,
    "19": 104,
    "24": 98,
    "20": 97,
    "7": 96,
    "27": 82,
    "3": 65,
    "31": 60,
    "12": 48,
    "2": 46,
    "28": 43,
    "13": 37
  }
}
2025-07-17 16:36:52,581 - baseline.data.data_loader_preprocessor - INFO - Applying OpenVA transformation
2025-07-17 16:36:53,044 - baseline.data.data_loader_preprocessor - INFO - OpenVA transformation complete: 7582 records
2025-07-17 16:36:53,044 - baseline.data.data_loader_preprocessor - INFO - Converting categorical to numeric for ML models
2025-07-17 16:36:53,046 - baseline.data.data_loader_preprocessor - INFO - Converted 0 categorical columns to numeric
2025-07-17 16:36:53,048 - baseline.data.data_loader_preprocessor - INFO - Removed rows with missing va34 values. Final record count: 7582
2025-07-17 16:36:53,052 - baseline.data.data_loader_preprocessor - INFO - Data statistics at post-numeric-encoding: {
  "stage": "post-numeric-encoding",
  "n_samples": 7582,
  "n_features": 171,
  "missing_values": 0,
  "memory_usage_mb": 11.753469467163086,
  "n_classes": 34,
  "class_distribution": {
    "32": 607,
    "25": 581,
    "26": 528,
    "1": 474,
    "21": 451,
    "9": 402,
    "29": 402,
    "22": 400,
    "17": 393,
    "6": 303,
    "34": 266,
    "23": 251,
    "10": 224,
    "30": 194,
    "4": 190,
    "14": 168,
    "8": 167,
    "16": 161,
    "18": 150,
    "5": 148,
    "33": 121,
    "15": 119,
    "11": 106,
    "19": 104,
    "24": 98,
    "20": 97,
    "7": 96,
    "27": 82,
    "3": 65,
    "31": 60,
    "12": 48,
    "2": 46,
    "28": 43,
    "13": 37
  }
}
2025-07-17 16:36:53,168 - baseline.data.data_loader_preprocessor - INFO - Saved 7582 records to results/baseline/processed_data/adult_numeric_20250717_163653.csv
2025-07-17 16:36:53,169 - baseline.data.data_loader_preprocessor - INFO - Saved metadata to results/baseline/processed_data/adult_numeric_20250717_163653.metadata.json
2025-07-17 16:36:53,169 - baseline.data.data_loader_preprocessor - INFO - Processed data saved to: results/baseline/processed_data/adult_numeric_20250717_163653.csv
2025-07-17 16:36:53,176 - __main__ - INFO - Processed 7582 records for ML
2025-07-17 16:36:53,176 - __main__ - INFO - Shape: (7582, 171)
2025-07-17 16:36:53,176 - __main__ - INFO - Columns: ['site', 'va34', 'cod5', 'g1_05', 'g1_05_s1', 'g1_07a', 'a1_01_1', 'a1_01_2', 'a1_01_3', 'a1_01_4']...
2025-07-17 16:36:53,176 - __main__ - INFO - 
Sample of processed data (first 5 rows, first 5 columns):
2025-07-17 16:36:53,177 - __main__ - INFO - 
============================================================
2025-07-17 16:36:53,177 - __main__ - INFO - Example 2: Processing data for InSilicoVA (OpenVA encoding)
2025-07-17 16:36:53,177 - __main__ - INFO - ============================================================
2025-07-17 16:36:53,177 - baseline.data.data_loader_preprocessor - INFO - Output directories created at: results/baseline/processed_data
2025-07-17 16:36:53,177 - baseline.data.data_loader_preprocessor - INFO - Initialized VADataProcessor with config: data_path='data/raw/PHMRC/IHME_PHMRC_VA_DATA_ADULT_Y2013M09D11_0.csv' output_dir='results/baseline/' openva_encoding=True drop_columns=[] stratify_by_site=False
2025-07-17 16:36:53,178 - baseline.data.data_loader_preprocessor - INFO - Loading PHMRC data from data/raw/PHMRC/IHME_PHMRC_VA_DATA_ADULT_Y2013M09D11_0.csv
2025-07-17 16:36:55,705 - baseline.data.data_loader_preprocessor - INFO - Validated 7582 records with 197 columns
2025-07-17 16:36:55,817 - baseline.data.data_loader_preprocessor - INFO - Data statistics at post-validation: {
  "stage": "post-validation",
  "n_samples": 7582,
  "n_features": 197,
  "missing_values": 0,
  "memory_usage_mb": 65.29185104370117,
  "n_classes": 34,
  "class_distribution": {
    "32": 607,
    "25": 581,
    "26": 528,
    "1": 474,
    "21": 451,
    "9": 402,
    "29": 402,
    "22": 400,
    "17": 393,
    "6": 303,
    "34": 266,
    "23": 251,
    "10": 224,
    "30": 194,
    "4": 190,
    "14": 168,
    "8": 167,
    "16": 161,
    "18": 150,
    "5": 148,
    "33": 121,
    "15": 119,
    "11": 106,
    "19": 104,
    "24": 98,
    "20": 97,
    "7": 96,
    "27": 82,
    "3": 65,
    "31": 60,
    "12": 48,
    "2": 46,
    "28": 43,
    "13": 37
  }
}
2025-07-17 16:36:55,817 - baseline.data.data_loader_preprocessor - INFO - Applying OpenVA transformation
2025-07-17 16:36:56,296 - baseline.data.data_loader_preprocessor - INFO - OpenVA transformation complete: 7582 records
2025-07-17 16:36:56,296 - baseline.data.data_loader_preprocessor - INFO - Applying OpenVA encoding for InSilicoVA
2025-07-17 16:36:56,390 - baseline.data.data_loader_preprocessor - INFO - OpenVA encoding applied to 168 feature columns
2025-07-17 16:36:56,497 - baseline.data.data_loader_preprocessor - INFO - Data statistics at post-openva-encoding: {
  "stage": "post-openva-encoding",
  "n_samples": 7582,
  "n_features": 171,
  "missing_values": 0,
  "memory_usage_mb": 60.65780448913574,
  "n_classes": 34,
  "class_distribution": {
    "32": 607,
    "25": 581,
    "26": 528,
    "1": 474,
    "21": 451,
    "9": 402,
    "29": 402,
    "22": 400,
    "17": 393,
    "6": 303,
    "34": 266,
    "23": 251,
    "10": 224,
    "30": 194,
    "4": 190,
    "14": 168,
    "8": 167,
    "16": 161,
    "18": 150,
    "5": 148,
    "33": 121,
    "15": 119,
    "11": 106,
    "19": 104,
    "24": 98,
    "20": 97,
    "7": 96,
    "27": 82,
    "3": 65,
    "31": 60,
    "12": 48,
    "2": 46,
    "28": 43,
    "13": 37
  }
}
2025-07-17 16:36:56,567 - baseline.data.data_loader_preprocessor - INFO - Saved 7582 records to results/baseline/processed_data/adult_openva_20250717_163656.csv
2025-07-17 16:36:56,568 - baseline.data.data_loader_preprocessor - INFO - Saved metadata to results/baseline/processed_data/adult_openva_20250717_163656.metadata.json
2025-07-17 16:36:56,568 - baseline.data.data_loader_preprocessor - INFO - Processed data saved to: results/baseline/processed_data/adult_openva_20250717_163656.csv
2025-07-17 16:36:56,575 - __main__ - INFO - Processed 7582 records for InSilicoVA
2025-07-17 16:36:56,575 - __main__ - INFO - Shape: (7582, 171)
2025-07-17 16:36:56,575 - __main__ - INFO - 
Sample of OpenVA encoded data (first 5 rows, columns 3-7):
2025-07-17 16:36:56,576 - __main__ - INFO - 
============================================================
2025-07-17 16:36:56,576 - __main__ - INFO - Example 3: Processing with site stratification
2025-07-17 16:36:56,576 - __main__ - INFO - ============================================================
2025-07-17 16:36:56,576 - baseline.data.data_loader_preprocessor - INFO - Output directories created at: results/baseline/processed_data
2025-07-17 16:36:56,576 - baseline.data.data_loader_preprocessor - INFO - Initialized VADataProcessor with config: data_path='data/raw/PHMRC/IHME_PHMRC_VA_DATA_ADULT_Y2013M09D11_0.csv' output_dir='results/baseline/' openva_encoding=False drop_columns=[] stratify_by_site=True
2025-07-17 16:36:56,576 - baseline.data.data_loader_preprocessor - INFO - Loading data for site stratification
2025-07-17 16:36:59,085 - baseline.data.data_loader_preprocessor - INFO - Found 6 sites: ['Mexico' 'AP' 'UP' 'Dar' 'Bohol' 'Pemba']
2025-07-17 16:36:59,085 - baseline.data.data_loader_preprocessor - INFO - Processing site: Mexico
2025-07-17 16:36:59,091 - __main__ - ERROR - Error during processing: unhashable type: 'DataFrame'
2025-07-17 16:36:59,091 - __main__ - ERROR - Full traceback:
Traceback (most recent call last):
  File "/Users/ericliu/projects5/context-engineering-intro/baseline/example_usage.py", line 102, in main
    site_results = processor_stratified.process_with_site_stratification()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ericliu/projects5/context-engineering-intro/baseline/data/data_loader_preprocessor.py", line 323, in process_with_site_stratification
    site_df = va_data.xform("openva", site_df)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ericliu/projects5/context-engineering-intro/va-data/va_data/va_data.py", line 170, in xform
    data = VAData._xfuncs[self.__class__.__name__][group][xfunc](self.vdata)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
TypeError: unhashable type: 'DataFrame'
